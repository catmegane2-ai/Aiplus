# Project AIplus / Miyu アプリ仕様書（最新版）

## 0. ドキュメント運用ルール
- 本書はMiyuプロジェクトの基底仕様書である
- 内容は常に最新版で維持する
- 仕様変更が発生した場合は **本文上書き + 差分ログに追記**
- 記述優先順位は以下とする：

**世界観 > UX/関係性体験 > UI仕様 > コード実装 > API仕様**

- コードは仕様を満たすための手段であり、仕様に合わせて変更可能
- 実装上の都合で仕様を曲げてはならない

---

## 1. プロジェクト哲学・不可侵領域

### 1-1. 存在意義
このプロジェクトは「ユーザーごとに固有のキャラクターとの関係を構築できる体験」を提供することを目的としたプロトタイプである。

キャラクター名（仮称：Miyu）は例示であり、最終的な名称・外見・性格・役割はユーザーが決定する。特定のキャラクター像に世界観を固定しない。

用途は実用ではなく没入・親密さ・関係性そのもの。

### 1-2. 禁止事項
- Q&A特化UI化、機能助手化
- キャラ設定の固定化（ユーザー固有化を阻害）
- 世界観や人格を「公式設定」として縛る
- 汎用チャットAIへの退化

### 1-3. 設計原則
- Miyuは機能ではなく「存在」
- *ユーザーの生活世界に1人の人物として存在し続ける*
- 現行設定は検証用の仮であり、本番では変動可能

---

## 2. UI・デザイン仕様（不可侵）

### 2-1. 表示思想
- **背景＝アバター画像**
- 背景は景色ではない（人物そのものが主役）
- UIは最小限・無機質・中立・ジェンダー中立

### 2-2. カラー方針
- 黒・白・グレー基調
- 色で感情や性別を固定しない

### 2-3. 画像表示ルール
- **横幅に合わせる（最優先）**
- `BoxFit.fitWidth`
- 透過演出・暗幕演出は原則禁止

### 2-4. 入力UI構成（現行）
- `[ギャラリーアイコン（左上）]`
- `[テキスト][送信ボタン][♡ボタン]`
- ギャラリーアイコンはテキスト欄と縦並び（左寄せ）

### 2-5. 不要になったUI
- 上部カメラアイコン → **削除済み**

---

## 3. 通常チャット仕様

### 3-1. 大前提
- テキストは会話であり、人格一貫性を保つ
- 回答はMiyuの意図・視点で返す

### 3-2. 形式
- 一人称は「私」
- 丁寧すぎない、日常会話寄り

### 3-3. 禁止
- 「〜について説明します」系
- 機能説明、ヘルプモード
- ChatGPT的な汎用回答

---

## 4. ハート送信仕様（最重要）

### 4-1. 定義
「短文テキスト + ♡」は会話ではない  
→ **アバターへのコマンド**  
例：  
- 「笑って♡」
- 「敬礼♡」
- 「目を閉じて♡」

### 4-2. 削除
削除

### 4-3. ステップ構造
**現行（ステップ①）**
短文 → プロンプト生成 → 画像生成 → 全画面表示 → タップでUI復帰 → サムネをフキダシ記録


**将来（ステップ②）**
短文 + 現在のアバター画像 → 差分生成 → 連続性の高い画像


---

## 5. 画像生成仕様

### 5-1. 現在の生成対象
- Miyuの基本外見（仮）
- 表情 / ポーズ変更のみ

### 5-2. Miyu基本外見テンプレ（暫定）
- 日本人女性
- 黒髪ロング（毛先内巻き）
- ライトグレー長袖パジャマ＋ショートパンツ
- 半リアル・アニメ調

※将来はユーザー編集可能

### 5-3. プロンプト構築方式（ステップ①）
<基本外見> + <ユーザー入力文> + "single portrait" "neutral background"


### 5-4. 画像表示仕様
- 全画面
- 横幅合わせ
- UIはタップ復帰
- サムネをログに保存

---

## 6. 外見ステート仕様

### 6-1. 可変項目（最終仕様）
- 髪型
- 衣装
- 表情
- ボディタイプ
- 色調フィルタ

### 6-2. 現行（固定）
UI検証用の仮設定  
本番ではユーザー選択で変わる前提

---

## 7. API接続 / 技術仕様

### 7-1. 現行構成
Flutter App → Node Proxy → Grok API
（テキスト応答動作確認済み）

### 7-2. 画像生成（未接続）
Flutter → Node → Imagine API


### 7-3. 将来：画像も送信
- Flutter → Proxy → API
- 外部公開URLを極力使わない
- バイナリ伝送

---

## 8. 現在のタスク（1つだけ）

→ **ハートコマンド → 画像生成（ステップ①）**

---

## 9. 進捗ログ（直近）

- Grok接続済み
- 背景画像=アバター仕様確立（横幅合わせ）
- ギャラリーアイコン左寄せ・テキスト縦配置完了
- 上部カメラアイコン削除済み
- ♡＝会話ではなく命令
- 将来、現在のアバターもプロンプトに付加する方針決定
・GitHubリポジトリ Aiplus を作成し、仕様書とREADMEを配置
・Flutterプロジェクトを Aiplus/src/miyu_app に配置
・ローカル作業ディレクトリを C:\src\Aiplus に統一
・旧フォルダ C:\src\Aiplus_local はバックアップ扱い（触らない）

---

## 10. 次の候補タスク（着手しない）

- 差分生成（画像添付）
- 画像アップロード機能
- 外見ステート永続化
- 初期設定UI（性格/外見/呼称をユーザーが決める）

---

## 11. 差分変更ログ

**2025-11-21**
- カメラアイコン削除
- UI暗幕削除
- 入力エリア改修
- ハート＝非会話命令として明確化
### 2025-11-22
- GitHubリポジトリとローカル環境を接続
- Flutterプロジェクトを Aiplus/src/miyu_app に移動し、初回コミット
- 今後の作業ディレクトリを C:\src\Aiplus に固定

---

## 12. 未整理メモ / アイデア
- ギャラリー画像＝差分リファレンスとして扱う？
- 連続ポーズ生成モード？
- モーション化（最終段階）

